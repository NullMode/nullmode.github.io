<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Getting Personal With PowerShell: Linux to PowerShell - Things all the hacking</title>
  <meta name="author" content="NullMode">

  
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://blog.nullmode.com/blog/2014/06/28/getting-personal-with-powershell">
  <link href="/favicon.png" type="image/png" rel="icon">
  <link href="/atom.xml" rel="alternate" title="Things all the hacking" type="application/atom+xml">

  <link href="/assets/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css">
<link href="/assets/bootstrap/dist/css/bootstrap-theme.min.css" rel="stylesheet" type="text/css">
<link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
<link href="/stylesheets/custom.css" rel="stylesheet" type="text/css">


  <script src="/javascripts/libs/jquery/jquery-2.0.3.min.js"></script>
  
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-51330433-1', 'nullmode.com');
  ga('require', 'displayfeatures');
  ga('send', 'pageview');

  </script>


</head>

  <body   >
    <div id="wrap">
      <header role="banner">
        <nav class="navbar navbar-default" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <img src="/images/nullmode.png" class="img-circle
            nullmode-logo" />
        </div>
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">Things all the hacking</a>
        </div>

        <div class="navbar-collapse collapse">
            <ul class="nav navbar-nav">
                <li class="active">
                    <a href="/">Blog</a>
                </li>
                <li >
                    <a href="/blog/archives">Archives</a>
                </li>
                <li >
                    <a href="/online-resources/">Online Resources</a>
                </li>
                <li >
                    <a href="/readme/">README.txt</a>
                </li>
                <li >
                    <a href="/pgp/">PGP</a>
                </li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a class="subscribe-rss" href="/atom.xml" title="subscribe via RSS">
                        <span class="visible-xs">RSS</span>
                        <img class="hidden-xs" src="/images/rss.png" alt="RSS">
                    </a>
                </li>
                
            </ul>
            
                <form class="search navbar-form navbar-right" action="https://www.google.com/search" method="GET">
                    <input type="hidden" name="q" value="site:blog.nullmode.com">
                    <div class="form-group">
                        <input class="form-control" type="text" name="q" placeholder="Search">
                    </div>
                </form>
            
        </div>
    </div>
</nav>


      </header>
      <div id="main" class="container">
        <div id="content">
          <div class="row">
  <div class="page-content col-md-9">
    <article class="hentry" role="article">
      
  <header class="page-header page-header-adjustment">
    
      <p class="meta text-muted text-uppercase">
        












<span class="glyphicon glyphicon-calendar"></span> <time datetime="2014-06-28T13:00:00+01:00" pubdate data-updated="true">Jun 28<span>th</span>, 2014</time>
        
      </p>
    
    
    <a href="">
        <h1 class="entry-title">
            Getting Personal With PowerShell: Linux to PowerShell
            
        </h1>
    </a>
    
  </header>


<div class="entry-content clearfix"><p>Running Windows as a main OS can be tough times for many hard core Linux users, especially when you want some command line power. PowerShell at first glance looks alien to some, but under closer inspection it&rsquo;s not a million miles away from what you can achieve in a Bash shell.</p>

<p>If you’re like me you&rsquo;ll have a few handy aliases that save a bit of time whilst working in your Linux environment. For example the below aliases save having to type out long commands that you may use quite often:</p>

<pre><code>alias lsa="ls -lsahS"

alias screen="screen -xRR"

alias ..="cd .."
alias ...="cd ../.."
alias ....="cd ../../.."
alias .....="cd ../../../..”

alias upd="sudo apt-get update"
alias upg="sudo apt-get upgrade"
alias ins="sudo apt-get install"
alias rem="sudo apt-get purge"
alias fix="sudo apt-get install -f"
</code></pre>

<p>If you find yourself dropping into a Linux virtual machine to use the command line functionality you may be surprised to learn that a lot of the same functionality can be achieved with PowerShell. PowerShell handles everything as an object which makes piping between commands very powerful. For example, if I want to return the full path for every file in the current directory I could do the following:</p>

<pre><code>Get-ChildItem | Select-Object fullname
</code></pre>

<p>Each file returned is piped to the select command to get the <strong>fullname</strong> attribute of the file object.</p>

<p>It&rsquo;s worth learning about the PowerShell equivalents of some of the commands you might run in a Linux shell. Below I&rsquo;ve put some of the more familiar Linux command line binaries and their PowerShell counterparts.</p>

<br />


<h4>Listing running processes</h4>

<p><strong>Linux</strong></p>

<pre><code>ps
</code></pre>

<p><strong>PowerShell</strong></p>

<pre><code>get-process
</code></pre>

<br />


<h4>Stopping a process</h4>

<p><strong>Linux</strong></p>

<pre><code>kill calc.exe
</code></pre>

<p><strong>PowerShell</strong></p>

<pre><code>get-process calc.exe | StopProcess
</code></pre>

<br />


<h4>Displaying a list of 1 to 10</h4>

<p><strong>Linux</strong></p>

<pre><code>seq 1 10
</code></pre>

<p><strong>PowerShell</strong></p>

<pre><code>1..10
</code></pre>

<br />


<h4>Print the first 10 lines of a file</h4>

<p><strong>Linux</strong></p>

<pre><code>head -n10 file.txt
</code></pre>

<p><strong>PowerShell</strong></p>

<pre><code>gc file.txt | select -first 10
</code></pre>

<br />


<h4>Print the last 10 lines of a file</h4>

<p><strong>Linux</strong></p>

<pre><code>tail -n10 file.txt
</code></pre>

<p><strong>PowerShell</strong></p>

<pre><code>gc file.txt | select -last 10 
</code></pre>

<br />


<h4>Count the lines in a file</h4>

<p><strong>Linux</strong></p>

<pre><code>wc -l file.txt
</code></pre>

<p><strong>PowerShell</strong></p>

<pre><code>gc file.txt | Measure-Object -Line 
</code></pre>

<br />


<h4>Print lines that contain the word “example”</h4>

<p><strong>Linux</strong></p>

<pre><code>grep example file.txt
</code></pre>

<p><strong>PowerShell</strong></p>

<pre><code>Select-Text example file.txt
</code></pre>

<br />


<h4>Split file using &ldquo;:&rdquo; as a delimiter and print the second item</h4>

<p><strong>Linux</strong></p>

<pre><code>awk -F ":" '{print $1}' file.txt
</code></pre>

<p><strong>PowerShell</strong></p>

<pre><code>gc file.txt | %{ $_.Split(':')[1]; }
</code></pre>

<br />


<h4>Replace the word “example” with “elpmaxe” in file.txt</h4>

<p><strong>Linux</strong></p>

<pre><code>cat file.txt | sed ’s/example/elpmaxe/‘
</code></pre>

<p><strong>PowerShell</strong></p>

<pre><code>gc test.txt | Select-String “example" | %{ $_ -replace ‘example', 'elpmaxe' }
</code></pre>

<br />


<p>There’s actually a lot of built in aliases in PowerShell already so if you find yourself loathing some long command string you might be pleased to know that their is probably already a shortcut for it already. You can find out what these are with the following command:</p>

<pre><code>Get-Alias
</code></pre>

<p>As you can see there are a few items in the list that would be familiar to you if you are from a Linux background. Aliases such as ls, cat and rm are just a few examples of aliases that you wont need to re-learn (or set up) for PowerShell. Remember that command at the start where I grabbed the full path for each file in the directory? That could have been simplified using these built in aliases.</p>

<pre><code>ls | select fullname
</code></pre>

<p>That&rsquo;s not so much of a pain to type is it?</p>

<h3>Setting up your PowerShell profile</h3>

<p>For practice I&rsquo;ll go through setting up the profile (mostly) in PowerShell. The PowerShell environment tries to load your profile information from the following file (may differ with different Windows operating systems):</p>

<pre><code>C:\Users\NullMode\Documents\WindowsPowerShell\Microsoft.PowerShell_profile.ps1
</code></pre>

<p>This file location is stored in the PowerShell environment variable $PROFILE as seen below:</p>

<pre><code>echo $PROFILE
C:\Users\NullMode\Documents\WindowsPowerShell\Microsoft.PowerShell_profile.ps1
</code></pre>

<p>Let&rsquo;s use this variable to create this file in this location:</p>

<pre><code>New-Item -type file -force $PROFILE
</code></pre>

<p>Hooray, we&rsquo;ve just made a PowerShell profile file.</p>

<h3>Adding aliases to our PowerShell profile file</h3>

<p>Let&rsquo;s open up that file from within PowerShell because we&rsquo;re gurus now:</p>

<pre><code>notepad $PROFILE
</code></pre>

<p>In a .bashrc/.bash_aliases file you can define functions that can be run as well as aliases, unfortunately this isn&rsquo;t possible with PowerShell. You must first define the function then use the New-Alias command to tie the function name to an alias that we can type into the prompt.</p>

<h5>With the open file let&rsquo;s add some aliases:</h5>

<p>How about a quick alias to run ipconfig:</p>

<pre><code>New-Alias ipconfig -value ip
</code></pre>

<p>If you want to do ipconfig /all the following would be required as you are supplying the name of the command and an argument:</p>

<pre><code>function ipconfig_all_function() {
    ipconfig /all
}
New-Alias -name ipa -value ipconfig_all_function
</code></pre>

<p>Change to your $HOME directory:</p>

<pre><code>cd_home_function() {
    cd $HOME
}
New-Alias -name home -value cd_home_function
</code></pre>

<p>Maybe a shortcut to open notepad if you&rsquo;re in a console window:</p>

<pre><code>New-Alias -name n -value notepad
</code></pre>

<p>Being lazy is cool remember:</p>

<pre><code>function exit_function() {
    exit
}
New-Alias -name x -value exit_function
</code></pre>

<p>Once you have some aliases in your profile file just save it and open a new PowerShell instance and test them out! You&rsquo;ll get an error if something is wrong in the file so you&rsquo;ll be able to correct yourself.</p>

<p>The aliases above are pretty simple. Here is one I&rsquo;ve made that sets up a git repository with some local configuration settings. This can be useful if you have multiple git servers using different user names and e-mails assigned to them.</p>

<pre><code>function gitinb_function() {
    git init
    git config --local user.name NullModeBitbucket
    git config --local user.email TheRealDeal@DealOrNoDeal.cn
}
New-Alias -name gitinb -value gitin_function

function giting_function() {
    git init
    git config --local user.name NullModeGithub
    git config --local user.email TheRealDeal@DealOrNoDeal.cn
}
New-Alias -name giting -value gitin_function
</code></pre>

<h3>More customization</h3>

<p>Here are a couple of places you can go to read about aliases and profile customization that you may wish to incorporate into your own profile file:</p>

<ul>
<li><a href="http://stackoverflow.com/questions/138144/whats-in-your-powershell-profile-ps1file">What&rsquo;s in your Powershell profile.ps1file?</a> &ndash; some cool examples from other PowerShell users</li>
<li><a href="http://www.howtogeek.com/50236/customizing-your-powershell-profile/">Customizing your PowerShell Profile</a> &ndash; A similar guide to this that has a nice example of pimping out the terminal itself</li>
</ul>


<h3>Bonus information!</h3>

<p>There&rsquo;s some special locations you can get to within PowerShell. I thought I&rsquo;d include them here while I remember as maybe someone will find them useful.</p>

<p>View the windows environment variables:</p>

<pre><code>cd env:
ls
</code></pre>

<p>View the Windows HIVE files:</p>

<pre><code>cd HKLM:
ls
</code></pre>

<p>If you want to find out about a particular item in one of of these locations you can do the following (remembering that past the tabbing through the items is possible):</p>

<pre><code>echo $Env:OS
</code></pre>

<h3>Shout-outs</h3>

<p>Thanks to <a href="https://twitter.com/lllamaboy" title="@lllamaboy">@lllamaboy</a> for giving me the first steps on setting up a python $PROFILE and letting me in on the whole special location thing.</p>
</div>


      <footer>
        <p class="meta text-muted">
          
  

<span class="glyphicon glyphicon-user"></span> <span class="byline author vcard">Posted by <span class="fn">NullMode</span></span>

          












<span class="glyphicon glyphicon-calendar"></span> <time datetime="2014-06-28T13:00:00+01:00" pubdate data-updated="true">Jun 28<span>th</span>, 2014</time>
          


        </p>
        
          <div class="sharing">
  
  <a href="//twitter.com/share" class="twitter-share-button" data-url="http://blog.nullmode.com/blog/2014/06/28/getting-personal-with-powershell/" data-via="NullMode_" data-counturl="http://blog.nullmode.com/blog/2014/06/28/getting-personal-with-powershell/" >Tweet</a>
  
  
  
</div>

        
        
          <ul class="meta text-muted pager">
            
            <li class="previous"><a href="/blog/2014/05/25/my-move-to-octopress/" title="Previous Post: My Move to Octopress">&laquo; My Move to Octopress</a></li>
            
            
          </ul>
        
      </footer>
    </article>
    
  </div>

  
  <aside class="sidebar col-md-3">
    
      <section class="panel panel-default">
  <div class="panel-heading">
    <h3 class="panel-title">Recent Posts</h3>
  </div>
  
  <div id="recent_posts" class="list-group">
    
    <a class="list-group-item active" href="/blog/2014/06/28/getting-personal-with-powershell/">Getting Personal With PowerShell: Linux to PowerShell</a>
    
    <a class="list-group-item " href="/blog/2014/05/25/my-move-to-octopress/">My Move to Octopress</a>
    
    <a class="list-group-item " href="/blog/2013/10/31/de-ice-s1-dot-100-level-1-a-beginners-guide/">De-ICE S1.100 (Level 1) - a Beginners Guide</a>
    
    <a class="list-group-item " href="/blog/2013/05/11/penetration-testing-with-backtrack-oscp/">Penetration Testing With Backtrack - OSCP</a>
    
  </div>
</section>

<section class="panel panel-default clearfix">
  <div class="panel-heading">
      <h3 class="panel-title">GitHub Repos</h3>
  </div>
  <div class="list-group" id="gh_repos">
    <p class="loading">Status updating...</p>
  </div>
  
    <div class="gh-profile-link pull-right text-muted">
      <a href="https://github.com/NullMode">@NullMode</a> on GitHub
    </div>
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'NullMode',
            count: 3,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>

 <section>
     <a class="twitter-timeline" data-dnt="true" href="https://twitter.com/NullMode_" data-widget-id="469541095303426049">Tweets by @NullMode_</a>
    <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+"://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
 </section>




    
  </aside>
  
</div>

        </div>
      </div>
    </div>
    <footer role="contentinfo"><div class="container">
    <p class="text-muted credits">
  Copyright &copy; 2015 - NullMode<br>
  <small>
      <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>,
      <span class="credit">customized with <a href="https://github.com/kAworu/octostrap3">octostrap3</a></span>.
  </small>
</p>

</div>
</footer>
    <script src="/assets/bootstrap/dist/js/bootstrap.min.js"></script>
<script src="/javascripts/modernizr-2.0.js"></script>








  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





  </body>
</html>
